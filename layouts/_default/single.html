{{ define "main" }}
{{ $catSlugs := dict "AI 技術前沿" "ai-tech" "AI 產業動態" "ai-industry" "AI 開發實戰" "ai-dev" "AI 安全與治理" "ai-safety" "科技巨頭觀察" "tech-giants" "地緣政治與經濟" "geopolitics" "領袖思維" "leadership" "職涯與學習" "career" }}
<article class="post-page">

  {{/* 文章標題區 */}}
  <header class="post-page__header">
    <div class="post-page__meta">
      {{/* 分類 */}}
      {{ with .Params.categories }}
        {{ range first 1 . }}
        {{ $slug := index $catSlugs . | default (. | urlize) }}
        <a href="{{ printf "/categories/%s/" $slug | relURL }}" class="post-page__category">{{ . }}</a>
        {{ end }}
      {{ end }}

      {{/* 日期 */}}
      <time class="post-page__date" datetime="{{ .Date.Format "2006-01-02" }}">
        {{ .Date.Format "2006 年 1 月 2 日" }}
      </time>
    </div>

    <h1 class="post-page__title">{{ .Title }}</h1>

    {{/* 摘要 */}}
    {{ with .Description }}
    <p class="post-page__excerpt">{{ . }}</p>
    {{ end }}

    {{/* 來源資訊 */}}
    {{ if or .Params.source_url .Params.source_name }}
    <div class="post-page__source">
      來源：
      {{ if .Params.source_url }}
      <a href="{{ .Params.source_url }}" target="_blank" rel="noopener">{{ .Params.source_name | default .Params.source_url }}</a>
      {{ else }}
      {{ .Params.source_name }}
      {{ end }}
    </div>
    {{ end }}
  </header>

  {{/* 封面圖 */}}
  {{ with .Params.image }}
  <figure class="post-page__cover">
    <img src="{{ . }}" alt="{{ $.Title }}">
  </figure>
  {{ end }}

  {{/* 文章內容 */}}
  <div class="post-page__content">
    {{ .Content }}
  </div>

  {{/* 標籤 */}}
  {{ with .Params.tags }}
  <footer class="post-page__footer">
    <div class="post-page__tags">
      {{ range . }}
      <a href="{{ printf "/tags/%s/" (. | urlize) | relURL }}" class="tag">{{ . }}</a>
      {{ end }}
    </div>
  </footer>
  {{ end }}

  {{/* 相關文章 */}}
  {{ $related := .Site.RegularPages.Related . | first 4 }}
  {{ with $related }}
  <aside class="post-page__related">
    <h2 class="post-page__related-title">相關文章</h2>
    <div class="post-page__related-grid">
      {{ range . }}
        {{ partial "v2/article-card.html" (dict "page" . "variant" "small") }}
      {{ end }}
    </div>
  </aside>
  {{ end }}

</article>
{{ end }}
